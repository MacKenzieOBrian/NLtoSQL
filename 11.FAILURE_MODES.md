# Failure Modes in NL→SQL Generation

Failures are categorized based on SQL semantics rather than surface string mismatch to better analyze structured model behavior.

---

## 1. Syntactic Errors (VA Failures)

Examples:
- missing comma
- malformed SELECT
- incorrect FROM syntax

Impact:
- prevented execution entirely
- more common in zero-shot and SFT(k=0)

---

## 2. Schema Reference Errors

### 2.1 Invalid columns
Model invents non-existent columns (hallucination)

### 2.2 Invalid tables
Invented tables such as `Employees` → `Employee`

### 2.3 Missing join relations
Model omits join despite multi-table requirement

---

## 3. Join Resolution Errors

Incorrect join paths:

- wrong foreign key
- missing join predicate
- Cartesian product join

Observed mostly in:

- zero-shot
- QLoRA without exemplars

---

## 4. Predicate / Filter Errors

Examples:

- wrong filter column
- swapped operands
- missing `WHERE` clause

This class directly affects EX.

---

## 5. Aggregation Errors

Subtypes:

| Type | Example |
|---|---|
| wrong aggregation | SUM vs COUNT |
| missing GROUP BY | syntax-valid but semantic-wrong |
| mis-specified HAVING | filters pre/post aggregation incorrectly |

Indicates poor relational reasoning.

---

## 6. Projection Errors

Cases:

- returning wrong fields
- incorrect aliasing
- returning extra columns

EM fails even when EX may succeed.

---

## 7. Sort / Limit Errors

Wrong orderings:

- ASC vs DESC
- missing ORDER BY
- missing LIMIT

Minor impact on EX depending on gold spec.

---

## 8. Accidental Correctness (TS-sensitive)

Queries that succeed on current DB instance but are semantically wrong.

TS guards against this behavior.

---

## 9. Summary Table

| Failure Mode | Impact | Affected Components |
|---|---|---|
| Syntax | VA | parsing |
| Schema | EX | grounding |
| Joins | EX/TS | relational reasoning |
| Aggregation | EX/TS | business semantics |
| Projection | EM | output shape |
| Sort/Limit | EX | ordering |
| Accidental | TS | robustness |

---


